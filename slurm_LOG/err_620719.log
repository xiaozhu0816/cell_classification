2026-01-05 14:28:19,574 | INFO | Experiment: multitask_resnet50
2026-01-05 14:28:19,575 | INFO | Run ID: 20260105-142819
2026-01-05 14:28:19,575 | INFO | Device: cuda
2026-01-05 14:28:19,575 | INFO | Config: {
  "experiment_name": "multitask_resnet50",
  "seed": 42,
  "data": {
    "infected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Infected_well/no_labels",
    "uninfected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Uninfected_well/no_labels",
    "infected_label": 1,
    "uninfected_label": 0,
    "split_ratios": [
      0.7,
      0.1,
      0.2
    ],
    "split_seed": 123,
    "batch_size": 128,
    "eval_batch_size_multiplier": 2,
    "num_workers": 4,
    "drop_last": false,
    "balance_sampler": false,
    "transforms": {
      "image_size": 512,
      "random_flip": true,
      "random_rotation": true,
      "color_jitter": false,
      "mean": [
        0.5,
        0.5,
        0.5
      ],
      "std": [
        0.25,
        0.25,
        0.25
      ]
    },
    "frames": {
      "frames_per_hour": 2.0,
      "infected_window_hours": [
        0,
        48
      ],
      "uninfected_window_hours": [
        0,
        48
      ],
      "infected_stride": 1,
      "uninfected_stride": 1,
      "uninfected_use_all": true
    }
  },
  "multitask": {
    "infection_onset_hour": 1.0,
    "clamp_range": [
      0.0,
      48.0
    ],
    "classification_weight": 1.0,
    "regression_weight": 1.0
  },
  "model": {
    "name": "resnet50",
    "pretrained": true,
    "num_classes": 2,
    "dropout": 0.2,
    "train_backbone": true,
    "hidden_dim": 256
  },
  "training": {
    "epochs": 30,
    "amp": true,
    "grad_clip": 1.0,
    "checkpoint_dir": "checkpoints"
  },
  "optimizer": {
    "lr": 0.0001,
    "weight_decay": 0.0001
  },
  "scheduler": {
    "t_max": 30,
    "eta_min": 1e-06
  }
}
2026-01-05 14:28:19,575 | INFO | Multi-task config:
2026-01-05 14:28:19,575 | INFO |   - Infection onset: 1.0h
2026-01-05 14:28:19,575 | INFO |   - Clamp range: (0.0, 48.0)
2026-01-05 14:28:19,575 | INFO |   - Loss weights: cls=1.0, reg=1.0
2026-01-05 14:28:19,575 | INFO | Building datasets...
2026-01-05 14:28:20,360 | INFO | Train samples: 4650
2026-01-05 14:28:20,360 | INFO | Val samples: 558
2026-01-05 14:28:20,360 | INFO | Test samples: 1488
2026-01-05 14:28:21,216 | INFO | Model: MultiTaskResNet
2026-01-05 14:28:21,217 | INFO | Total parameters: 24,557,891
2026-01-05 14:28:21,218 | INFO | Optimizer: AdamW with lr=0.0001
2026-01-05 14:28:21,218 | INFO | Scheduler: CosineAnnealingLR
2026-01-05 14:28:21,220 | INFO | Training for 30 epochs...
2026-01-05 14:28:21,220 | INFO | Primary metric: combined (0.6*F1 + 0.4*(1-MAE/48.0))
2026-01-05 14:28:21,221 | INFO |   - Balances classification F1 and regression MAE
2026-01-05 14:28:21,221 | INFO |   - Prevents AUC saturation at 1.0
2026-01-05 14:28:21,221 | INFO | ================================================================================
2026-01-05 14:28:21,221 | INFO | Epoch 1/30
train_e1:   0%|          | 0/145 [00:00<?, ?it/s]train_e1:   1%|          | 1/145 [00:05<14:18,  5.96s/it]train_e1:   1%|▏         | 2/145 [00:06<06:03,  2.54s/it]train_e1:   2%|▏         | 3/145 [00:06<03:22,  1.43s/it]train_e1:   3%|▎         | 4/145 [00:06<02:07,  1.10it/s]train_e1:   3%|▎         | 5/145 [00:09<03:37,  1.56s/it]train_e1:   4%|▍         | 6/145 [00:09<02:28,  1.07s/it]train_e1:   5%|▍         | 7/145 [00:09<01:43,  1.33it/s]train_e1:   6%|▌         | 8/145 [00:09<01:14,  1.83it/s]train_e1:   6%|▌         | 9/145 [00:13<03:27,  1.53s/it]train_e1:   7%|▋         | 10/145 [00:13<02:26,  1.09s/it]train_e1:   8%|▊         | 11/145 [00:13<01:45,  1.27it/s]train_e1:   8%|▊         | 12/145 [00:13<01:17,  1.72it/s]train_e1:   9%|▉         | 13/145 [00:16<03:12,  1.46s/it]train_e1:  10%|▉         | 14/145 [00:16<02:18,  1.05s/it]train_e1:  10%|█         | 15/145 [00:17<01:39,  1.30it/s]train_e1:  11%|█         | 16/145 [00:17<01:13,  1.76it/s]train_e1:  12%|█▏        | 17/145 [00:20<03:03,  1.44s/it]train_e1:  12%|█▏        | 18/145 [00:20<02:14,  1.06s/it]train_e1:  13%|█▎        | 19/145 [00:20<01:37,  1.29it/s]train_e1:  14%|█▍        | 20/145 [00:21<01:11,  1.75it/s]train_e1:  14%|█▍        | 21/145 [00:24<02:53,  1.40s/it]train_e1:  15%|█▌        | 22/145 [00:24<02:09,  1.05s/it]train_e1:  16%|█▌        | 23/145 [00:24<01:33,  1.30it/s]train_e1:  17%|█▋        | 24/145 [00:24<01:08,  1.76it/s]train_e1:  17%|█▋        | 25/145 [00:28<02:49,  1.41s/it]train_e1:  18%|█▊        | 26/145 [00:28<02:02,  1.03s/it]train_e1:  19%|█▊        | 27/145 [00:28<01:29,  1.32it/s]train_e1:  19%|█▉        | 28/145 [00:28<01:05,  1.78it/s]train_e1:  20%|██        | 29/145 [00:31<02:43,  1.41s/it]train_e1:  21%|██        | 30/145 [00:32<01:57,  1.02s/it]train_e1:  21%|██▏       | 31/145 [00:32<01:24,  1.34it/s]train_e1:  22%|██▏       | 32/145 [00:32<01:02,  1.81it/s]train_e1:  23%|██▎       | 33/145 [00:35<02:36,  1.40s/it]train_e1:  23%|██▎       | 34/145 [00:35<01:52,  1.02s/it]train_e1:  24%|██▍       | 35/145 [00:35<01:21,  1.35it/s]train_e1:  25%|██▍       | 36/145 [00:35<01:00,  1.81it/s]train_e1:  26%|██▌       | 37/145 [00:39<02:31,  1.41s/it]train_e1:  26%|██▌       | 38/145 [00:39<01:48,  1.02s/it]train_e1:  27%|██▋       | 39/145 [00:39<01:18,  1.34it/s]train_e1:  28%|██▊       | 40/145 [00:39<00:58,  1.81it/s]train_e1:  28%|██▊       | 41/145 [00:43<02:27,  1.41s/it]train_e1:  29%|██▉       | 42/145 [00:43<01:45,  1.02s/it]train_e1:  30%|██▉       | 43/145 [00:43<01:16,  1.34it/s]train_e1:  30%|███       | 44/145 [00:43<00:56,  1.80it/s]train_e1:  31%|███       | 45/145 [00:46<02:20,  1.40s/it]train_e1:  32%|███▏      | 46/145 [00:46<01:40,  1.01s/it]train_e1:  32%|███▏      | 47/145 [00:47<01:13,  1.33it/s]train_e1:  33%|███▎      | 48/145 [00:47<00:54,  1.79it/s]train_e1:  34%|███▍      | 49/145 [00:50<02:14,  1.40s/it]train_e1:  34%|███▍      | 50/145 [00:50<01:36,  1.01s/it]train_e1:  35%|███▌      | 51/145 [00:50<01:12,  1.29it/s]train_e1:  36%|███▌      | 52/145 [00:50<00:53,  1.74it/s]train_e1:  37%|███▋      | 53/145 [00:54<02:07,  1.39s/it]train_e1:  37%|███▋      | 54/145 [00:54<01:31,  1.00s/it]train_e1:  38%|███▊      | 55/145 [00:54<01:09,  1.30it/s]train_e1:  39%|███▊      | 56/145 [00:54<00:50,  1.75it/s]train_e1:  39%|███▉      | 57/145 [00:57<02:01,  1.38s/it]train_e1:  40%|████      | 58/145 [00:58<01:26,  1.00it/s]train_e1:  41%|████      | 59/145 [00:58<01:06,  1.30it/s]train_e1:  41%|████▏     | 60/145 [00:58<00:48,  1.75it/s]train_e1:  42%|████▏     | 61/145 [01:01<01:55,  1.37s/it]train_e1:  43%|████▎     | 62/145 [01:01<01:22,  1.00it/s]train_e1:  43%|████▎     | 63/145 [01:01<01:03,  1.30it/s]train_e1:  44%|████▍     | 64/145 [01:02<00:46,  1.75it/s]train_e1:  45%|████▍     | 65/145 [01:05<01:52,  1.40s/it]train_e1:  46%|████▌     | 66/145 [01:05<01:22,  1.05s/it]train_e1:  46%|████▌     | 67/145 [01:05<01:01,  1.28it/s]train_e1:  47%|████▋     | 68/145 [01:05<00:44,  1.73it/s]train_e1:  48%|████▊     | 69/145 [01:09<01:52,  1.48s/it]train_e1:  48%|████▊     | 70/145 [01:09<01:22,  1.11s/it]train_e1:  49%|████▉     | 71/145 [01:09<01:02,  1.19it/s]train_e1:  50%|████▉     | 72/145 [01:10<00:45,  1.61it/s]train_e1:  50%|█████     | 73/145 [01:13<01:48,  1.50s/it]train_e1:  51%|█████     | 74/145 [01:13<01:18,  1.11s/it]train_e1:  52%|█████▏    | 75/145 [01:14<01:00,  1.17it/s]train_e1:  52%|█████▏    | 76/145 [01:14<00:43,  1.58it/s]train_e1:  53%|█████▎    | 77/145 [01:17<01:40,  1.48s/it]train_e1:  54%|█████▍    | 78/145 [01:17<01:15,  1.12s/it]train_e1:  54%|█████▍    | 79/145 [01:18<00:56,  1.17it/s]train_e1:  55%|█████▌    | 80/145 [01:18<00:40,  1.59it/s]train_e1:  56%|█████▌    | 81/145 [01:21<01:32,  1.45s/it]train_e1:  57%|█████▋    | 82/145 [01:22<01:14,  1.18s/it]train_e1:  57%|█████▋    | 83/145 [01:22<00:53,  1.16it/s]train_e1:  58%|█████▊    | 84/145 [01:22<00:38,  1.57it/s]train_e1:  59%|█████▊    | 85/145 [01:25<01:22,  1.37s/it]train_e1:  59%|█████▉    | 86/145 [01:26<01:08,  1.16s/it]train_e1:  60%|██████    | 87/145 [01:26<00:50,  1.14it/s]train_e1:  61%|██████    | 88/145 [01:26<00:36,  1.55it/s]train_e1:  61%|██████▏   | 89/145 [01:29<01:08,  1.23s/it]train_e1:  62%|██████▏   | 90/145 [01:29<00:59,  1.09s/it]train_e1:  63%|██████▎   | 91/145 [01:30<00:45,  1.18it/s]train_e1:  63%|██████▎   | 92/145 [01:30<00:33,  1.60it/s]train_e1:  64%|██████▍   | 93/145 [01:32<01:00,  1.17s/it]train_e1:  65%|██████▍   | 94/145 [01:33<00:57,  1.12s/it]train_e1:  66%|██████▌   | 95/145 [01:33<00:40,  1.23it/s]train_e1:  66%|██████▌   | 96/145 [01:34<00:31,  1.55it/s]train_e1:  67%|██████▋   | 97/145 [01:36<00:54,  1.13s/it]train_e1:  68%|██████▊   | 98/145 [01:37<00:52,  1.12s/it]train_e1:  68%|██████▊   | 99/145 [01:37<00:37,  1.23it/s]train_e1:  69%|██████▉   | 100/145 [01:37<00:30,  1.46it/s]train_e1:  70%|██████▉   | 101/145 [01:40<00:51,  1.17s/it]train_e1:  70%|███████   | 102/145 [01:41<00:49,  1.16s/it]train_e1:  71%|███████   | 103/145 [01:41<00:35,  1.18it/s]train_e1:  72%|███████▏  | 104/145 [01:41<00:28,  1.46it/s]train_e1:  72%|███████▏  | 105/145 [01:44<00:47,  1.18s/it]train_e1:  73%|███████▎  | 106/145 [01:45<00:49,  1.27s/it]train_e1:  74%|███████▍  | 107/145 [01:45<00:35,  1.08it/s]train_e1:  74%|███████▍  | 108/145 [01:45<00:25,  1.47it/s]train_e1:  75%|███████▌  | 109/145 [01:48<00:43,  1.22s/it]train_e1:  76%|███████▌  | 110/145 [01:49<00:44,  1.27s/it]train_e1:  77%|███████▋  | 111/145 [01:49<00:31,  1.07it/s]train_e1:  77%|███████▋  | 112/145 [01:49<00:22,  1.46it/s]train_e1:  78%|███████▊  | 113/145 [01:52<00:39,  1.23s/it]train_e1:  79%|███████▊  | 114/145 [01:53<00:39,  1.27s/it]train_e1:  79%|███████▉  | 115/145 [01:53<00:27,  1.09it/s]train_e1:  80%|████████  | 116/145 [01:53<00:19,  1.48it/s]train_e1:  81%|████████  | 117/145 [01:56<00:32,  1.16s/it]train_e1:  81%|████████▏ | 118/145 [01:58<00:37,  1.39s/it]train_e1:  82%|████████▏ | 119/145 [01:58<00:26,  1.00s/it]train_e1:  83%|████████▎ | 120/145 [01:58<00:18,  1.36it/s]train_e1:  83%|████████▎ | 121/145 [01:59<00:22,  1.06it/s]train_e1:  84%|████████▍ | 122/145 [02:02<00:34,  1.48s/it]train_e1:  85%|████████▍ | 123/145 [02:02<00:23,  1.07s/it]train_e1:  86%|████████▌ | 124/145 [02:02<00:16,  1.28it/s]train_e1:  86%|████████▌ | 125/145 [02:03<00:16,  1.22it/s]train_e1:  87%|████████▋ | 126/145 [02:06<00:29,  1.55s/it]train_e1:  88%|████████▊ | 127/145 [02:07<00:20,  1.12s/it]train_e1:  88%|████████▊ | 128/145 [02:07<00:13,  1.23it/s]train_e1:  89%|████████▉ | 129/145 [02:07<00:12,  1.27it/s]train_e1:  90%|████████▉ | 130/145 [02:11<00:23,  1.57s/it]train_e1:  90%|█████████ | 131/145 [02:11<00:15,  1.13s/it]train_e1:  91%|█████████ | 132/145 [02:11<00:10,  1.22it/s]train_e1:  92%|█████████▏| 133/145 [02:11<00:07,  1.65it/s]train_e1:  92%|█████████▏| 134/145 [02:14<00:15,  1.38s/it]train_e1:  93%|█████████▎| 135/145 [02:14<00:10,  1.00s/it]train_e1:  94%|█████████▍| 136/145 [02:14<00:06,  1.36it/s]train_e1:  94%|█████████▍| 137/145 [02:15<00:04,  1.83it/s]train_e1:  95%|█████████▌| 138/145 [02:18<00:09,  1.35s/it]train_e1:  96%|█████████▌| 139/145 [02:18<00:05,  1.02it/s]train_e1:  97%|█████████▋| 140/145 [02:18<00:03,  1.40it/s]train_e1:  97%|█████████▋| 141/145 [02:18<00:02,  1.87it/s]train_e1:  98%|█████████▊| 142/145 [02:21<00:03,  1.30s/it]train_e1:  99%|█████████▊| 143/145 [02:21<00:01,  1.06it/s]train_e1:  99%|█████████▉| 144/145 [02:21<00:00,  1.45it/s]train_e1: 100%|██████████| 145/145 [02:22<00:00,  1.94it/s]                                                           2026-01-05 14:30:43,309 | INFO | train_e1 - total_loss: 6.2359 | cls_loss: 0.1946 | reg_loss: 6.0413
val_e1:   0%|          | 0/18 [00:00<?, ?it/s]val_e1:   6%|▌         | 1/18 [00:04<01:09,  4.10s/it]val_e1:  17%|█▋        | 3/18 [00:04<00:16,  1.10s/it]val_e1:  28%|██▊       | 5/18 [00:08<00:20,  1.54s/it]val_e1:  39%|███▉      | 7/18 [00:08<00:10,  1.08it/s]val_e1:  50%|█████     | 9/18 [00:12<00:11,  1.31s/it]val_e1:  61%|██████    | 11/18 [00:12<00:06,  1.14it/s]val_e1:  72%|███████▏  | 13/18 [00:16<00:06,  1.29s/it]val_e1:  83%|████████▎ | 15/18 [00:16<00:02,  1.12it/s]val_e1:  94%|█████████▍| 17/18 [00:20<00:01,  1.25s/it]                                                       2026-01-05 14:31:04,131 | INFO | val: total_loss:4.0693 | cls_loss:0.1438 | reg_loss:3.9255 | cls_accuracy:0.9606 | cls_precision:0.9673 | cls_recall:0.9534 | cls_f1:0.9603 | cls_auc:0.9917 | reg_mae:4.4067 | reg_rmse:5.9030 | reg_mse:34.8456 | combined:0.9395
2026-01-05 14:31:05,870 | INFO | ✓ New best model! combined=0.9395
2026-01-05 14:31:05,870 | INFO | ================================================================================
2026-01-05 14:31:05,870 | INFO | Epoch 2/30
train_e2:   0%|          | 0/145 [00:00<?, ?it/s]train_e2:   1%|          | 1/145 [00:04<09:47,  4.08s/it]train_e2:   1%|▏         | 2/145 [00:04<04:09,  1.74s/it]train_e2:   2%|▏         | 3/145 [00:04<02:21,  1.00it/s]train_e2:   3%|▎         | 4/145 [00:04<01:31,  1.54it/s]train_e2:   3%|▎         | 5/145 [00:08<04:10,  1.79s/it]train_e2:   4%|▍         | 6/145 [00:08<02:48,  1.22s/it]train_e2:   5%|▍         | 7/145 [00:08<01:57,  1.17it/s]train_e2:   6%|▌         | 8/145 [00:08<01:24,  1.63it/s]train_e2:   6%|▌         | 9/145 [00:12<03:38,  1.61s/it]train_e2:   7%|▋         | 10/145 [00:12<02:34,  1.14s/it]train_e2:   8%|▊         | 11/145 [00:12<01:50,  1.21it/s]train_e2:   8%|▊         | 12/145 [00:12<01:20,  1.65it/s]train_e2:   9%|▉         | 13/145 [00:16<03:25,  1.56s/it]train_e2:  10%|▉         | 14/145 [00:16<02:26,  1.12s/it]train_e2:  10%|█         | 15/145 [00:16<01:46,  1.23it/s]train_e2:  11%|█         | 16/145 [00:16<01:17,  1.66it/s]train_e2:  12%|█▏        | 17/145 [00:20<03:03,  1.43s/it]train_e2:  12%|█▏        | 18/145 [00:21<02:54,  1.37s/it]train_e2:  13%|█▎        | 19/145 [00:21<02:05,  1.01it/s]train_e2:  14%|█▍        | 20/145 [00:21<01:30,  1.38it/s]train_e2:  14%|█▍        | 21/145 [00:23<02:23,  1.16s/it]train_e2:  15%|█▌        | 22/145 [00:26<03:13,  1.57s/it]train_e2:  16%|█▌        | 23/145 [00:26<02:18,  1.13s/it]train_e2:  17%|█▋        | 24/145 [00:26<01:39,  1.21it/s]train_e2:  17%|█▋        | 25/145 [00:27<01:53,  1.06it/s]train_e2:  18%|█▊        | 26/145 [00:31<03:18,  1.67s/it]train_e2:  19%|█▊        | 27/145 [00:31<02:21,  1.20s/it]train_e2:  19%|█▉        | 28/145 [00:31<01:42,  1.15it/s]train_e2:  20%|██        | 29/145 [00:31<01:17,  1.49it/s]train_e2:  21%|██        | 30/145 [00:35<03:30,  1.83s/it]train_e2:  21%|██▏       | 31/145 [00:36<02:29,  1.31s/it]train_e2:  22%|██▏       | 32/145 [00:36<01:47,  1.05it/s]train_e2:  23%|██▎       | 33/145 [00:36<01:18,  1.43it/s]train_e2:  23%|██▎       | 34/145 [00:40<03:06,  1.68s/it]train_e2:  24%|██▍       | 35/145 [00:40<02:13,  1.21s/it]train_e2:  25%|██▍       | 36/145 [00:40<01:35,  1.14it/s]train_e2:  26%|██▌       | 37/145 [00:40<01:09,  1.55it/s]train_e2:  26%|██▌       | 38/145 [00:44<02:57,  1.66s/it]train_e2:  27%|██▋       | 39/145 [00:44<02:06,  1.20s/it]train_e2:  28%|██▊       | 40/145 [00:44<01:31,  1.15it/s]train_e2:  28%|██▊       | 41/145 [00:44<01:06,  1.56it/s]train_e2:  29%|██▉       | 42/145 [00:48<02:49,  1.64s/it]train_e2:  30%|██▉       | 43/145 [00:49<02:00,  1.18s/it]train_e2:  30%|███       | 44/145 [00:49<01:26,  1.16it/s]train_e2:  31%|███       | 45/145 [00:49<01:03,  1.58it/s]train_e2:  32%|███▏      | 46/145 [00:53<02:52,  1.74s/it]train_e2:  32%|███▏      | 47/145 [00:53<02:02,  1.25s/it]train_e2:  33%|███▎      | 48/145 [00:53<01:28,  1.10it/s]train_e2:  34%|███▍      | 49/145 [00:53<01:04,  1.50it/s]slurmstepd: error: *** JOB 620719 ON cia011 CANCELLED AT 2026-01-05T14:32:01 ***
