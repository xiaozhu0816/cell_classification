2025-12-15 16:43:54,809 | INFO | Experiment: multitask_resnet50
2025-12-15 16:43:54,810 | INFO | Run ID: 20251215-164354
2025-12-15 16:43:54,810 | INFO | Device: cuda
2025-12-15 16:43:54,810 | INFO | Config: {
  "experiment_name": "multitask_resnet50",
  "seed": 42,
  "data": {
    "infected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Infected_well/no_labels",
    "uninfected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Uninfected_well/no_labels",
    "infected_label": 1,
    "uninfected_label": 0,
    "split_ratios": [
      0.7,
      0.1,
      0.2
    ],
    "split_seed": 123,
    "batch_size": 128,
    "eval_batch_size_multiplier": 2,
    "num_workers": 4,
    "drop_last": false,
    "balance_sampler": false,
    "transforms": {
      "image_size": 512,
      "random_flip": true,
      "random_rotation": true,
      "color_jitter": false,
      "mean": [
        0.5,
        0.5,
        0.5
      ],
      "std": [
        0.25,
        0.25,
        0.25
      ]
    },
    "frames": {
      "frames_per_hour": 2.0,
      "infected_window_hours": [
        0,
        48
      ],
      "uninfected_window_hours": [
        0,
        48
      ],
      "infected_stride": 1,
      "uninfected_stride": 1,
      "uninfected_use_all": true
    }
  },
  "multitask": {
    "infection_onset_hour": 2.0,
    "clamp_range": [
      0.0,
      48.0
    ],
    "classification_weight": 1.0,
    "regression_weight": 1.0
  },
  "model": {
    "name": "resnet50",
    "pretrained": true,
    "num_classes": 2,
    "dropout": 0.2,
    "train_backbone": true,
    "hidden_dim": 256
  },
  "training": {
    "epochs": 20,
    "amp": true,
    "grad_clip": 1.0,
    "checkpoint_dir": "checkpoints"
  },
  "optimizer": {
    "lr": 0.0001,
    "weight_decay": 0.0001
  },
  "scheduler": {
    "t_max": 20,
    "eta_min": 1e-06
  }
}
2025-12-15 16:43:54,810 | INFO | Multi-task config:
2025-12-15 16:43:54,810 | INFO |   - Infection onset: 2.0h
2025-12-15 16:43:54,810 | INFO |   - Clamp range: (0.0, 48.0)
2025-12-15 16:43:54,810 | INFO |   - Loss weights: cls=1.0, reg=1.0
2025-12-15 16:43:54,811 | INFO | Building datasets...
2025-12-15 16:43:55,516 | INFO | Train samples: 4650
2025-12-15 16:43:55,516 | INFO | Val samples: 558
2025-12-15 16:43:55,516 | INFO | Test samples: 1488
2025-12-15 16:43:56,048 | INFO | Model: MultiTaskResNet
2025-12-15 16:43:56,049 | INFO | Total parameters: 24,557,891
2025-12-15 16:43:56,049 | INFO | Optimizer: AdamW with lr=0.0001
2025-12-15 16:43:56,049 | INFO | Scheduler: CosineAnnealingLR
2025-12-15 16:43:56,051 | INFO | Training for 20 epochs...
2025-12-15 16:43:56,051 | INFO | Primary metric: cls_auc
2025-12-15 16:43:56,051 | INFO | ================================================================================
2025-12-15 16:43:56,051 | INFO | Epoch 1/20
