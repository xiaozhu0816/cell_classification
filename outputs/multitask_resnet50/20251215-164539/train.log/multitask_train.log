2025-12-15 16:45:39,437 | INFO | Experiment: multitask_resnet50
2025-12-15 16:45:39,437 | INFO | Run ID: 20251215-164539
2025-12-15 16:45:39,437 | INFO | Device: cuda
2025-12-15 16:45:39,438 | INFO | Config: {
  "experiment_name": "multitask_resnet50",
  "seed": 42,
  "data": {
    "infected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Infected_well/no_labels",
    "uninfected_dir": "/isilon/datalake/gurcan_rsch/scratch/WSI/zhengjie/DATA/GMU_cell_1023/HBMVEC/Uninfected_well/no_labels",
    "infected_label": 1,
    "uninfected_label": 0,
    "split_ratios": [
      0.7,
      0.1,
      0.2
    ],
    "split_seed": 123,
    "batch_size": 128,
    "eval_batch_size_multiplier": 2,
    "num_workers": 4,
    "drop_last": false,
    "balance_sampler": false,
    "transforms": {
      "image_size": 512,
      "random_flip": true,
      "random_rotation": true,
      "color_jitter": false,
      "mean": [
        0.5,
        0.5,
        0.5
      ],
      "std": [
        0.25,
        0.25,
        0.25
      ]
    },
    "frames": {
      "frames_per_hour": 2.0,
      "infected_window_hours": [
        0,
        48
      ],
      "uninfected_window_hours": [
        0,
        48
      ],
      "infected_stride": 1,
      "uninfected_stride": 1,
      "uninfected_use_all": true
    }
  },
  "multitask": {
    "infection_onset_hour": 2.0,
    "clamp_range": [
      0.0,
      48.0
    ],
    "classification_weight": 1.0,
    "regression_weight": 1.0
  },
  "model": {
    "name": "resnet50",
    "pretrained": true,
    "num_classes": 2,
    "dropout": 0.2,
    "train_backbone": true,
    "hidden_dim": 256
  },
  "training": {
    "epochs": 20,
    "amp": true,
    "grad_clip": 1.0,
    "checkpoint_dir": "checkpoints"
  },
  "optimizer": {
    "lr": 0.0001,
    "weight_decay": 0.0001
  },
  "scheduler": {
    "t_max": 20,
    "eta_min": 1e-06
  }
}
2025-12-15 16:45:39,438 | INFO | Multi-task config:
2025-12-15 16:45:39,438 | INFO |   - Infection onset: 2.0h
2025-12-15 16:45:39,438 | INFO |   - Clamp range: (0.0, 48.0)
2025-12-15 16:45:39,438 | INFO |   - Loss weights: cls=1.0, reg=1.0
2025-12-15 16:45:39,438 | INFO | Building datasets...
2025-12-15 16:45:40,108 | INFO | Train samples: 4650
2025-12-15 16:45:40,109 | INFO | Val samples: 558
2025-12-15 16:45:40,109 | INFO | Test samples: 1488
2025-12-15 16:45:40,639 | INFO | Model: MultiTaskResNet
2025-12-15 16:45:40,639 | INFO | Total parameters: 24,557,891
2025-12-15 16:45:40,640 | INFO | Optimizer: AdamW with lr=0.0001
2025-12-15 16:45:40,640 | INFO | Scheduler: CosineAnnealingLR
2025-12-15 16:45:40,642 | INFO | Training for 20 epochs...
2025-12-15 16:45:40,642 | INFO | Primary metric: cls_auc
2025-12-15 16:45:40,642 | INFO | ================================================================================
2025-12-15 16:45:40,643 | INFO | Epoch 1/20
2025-12-15 16:48:09,727 | INFO | train_e1 - total_loss: 6.1057 | cls_loss: 0.1944 | reg_loss: 5.9113
2025-12-15 16:48:30,439 | INFO | val: total_loss:5.1041 | cls_loss:0.1548 | reg_loss:4.9493 | cls_accuracy:0.9552 | cls_precision:0.9262 | cls_recall:0.9892 | cls_f1:0.9567 | cls_auc:0.9965 | reg_mae:5.4363 | reg_rmse:7.0980 | reg_mse:50.3815
2025-12-15 16:48:32,077 | INFO | ✓ New best model! cls_auc=0.9965
2025-12-15 16:48:32,077 | INFO | ================================================================================
2025-12-15 16:48:32,077 | INFO | Epoch 2/20
2025-12-15 16:51:13,870 | INFO | train_e2 - total_loss: 2.7504 | cls_loss: 0.1051 | reg_loss: 2.6453
2025-12-15 16:51:35,400 | INFO | val: total_loss:1.7826 | cls_loss:0.0557 | reg_loss:1.7269 | cls_accuracy:0.9839 | cls_precision:0.9891 | cls_recall:0.9785 | cls_f1:0.9838 | cls_auc:0.9984 | reg_mae:2.1549 | reg_rmse:3.3346 | reg_mse:11.1194
2025-12-15 16:51:36,985 | INFO | ✓ New best model! cls_auc=0.9984
2025-12-15 16:51:36,986 | INFO | ================================================================================
2025-12-15 16:51:36,986 | INFO | Epoch 3/20
2025-12-15 16:54:19,476 | INFO | train_e3 - total_loss: 2.2909 | cls_loss: 0.0589 | reg_loss: 2.2320
2025-12-15 16:54:39,551 | INFO | val: total_loss:2.0282 | cls_loss:0.1586 | reg_loss:1.8696 | cls_accuracy:0.9677 | cls_precision:1.0000 | cls_recall:0.9355 | cls_f1:0.9667 | cls_auc:0.9892 | reg_mae:2.3209 | reg_rmse:3.5853 | reg_mse:12.8545
2025-12-15 16:54:39,551 | INFO | ================================================================================
2025-12-15 16:54:39,551 | INFO | Epoch 4/20
2025-12-15 16:57:13,665 | INFO | train_e4 - total_loss: 2.1796 | cls_loss: 0.0471 | reg_loss: 2.1325
2025-12-15 16:57:32,628 | INFO | val: total_loss:1.6140 | cls_loss:0.1052 | reg_loss:1.5087 | cls_accuracy:0.9642 | cls_precision:0.9924 | cls_recall:0.9355 | cls_f1:0.9631 | cls_auc:0.9985 | reg_mae:1.9375 | reg_rmse:3.1797 | reg_mse:10.1108
2025-12-15 16:57:34,575 | INFO | ✓ New best model! cls_auc=0.9985
2025-12-15 16:57:34,575 | INFO | ================================================================================
2025-12-15 16:57:34,575 | INFO | Epoch 5/20
